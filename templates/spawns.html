{% extends "base.html" %}

{% block title %}PoGo Intel | Spawn Atlas{% endblock %}
{% block meta_description %}Track wild spawn pools across active PokÃ©mon GO events with clean, tactical visualization.{% endblock %}

{% block content %}
<section class="hero reveal" style="background-image: url('https://images.unsplash.com/photo-1504333638930-c8787321eee0?auto=format&fit=crop&w=1600&q=80');">
    <div class="hero-content">
        <p class="eyebrow">[ WILD ENCOUNTER GRID ]</p>
        <h1 class="hero-line-a">Spawn Signal beyond</h1>
        <h2 class="hero-line-b">Noise.</h2>
        <p class="hero-copy">
            Observe active encounter pools, compare spawn density across events, and route your hunt with higher precision.
        </p>
        <a href="#spawn-grid" class="btn-magnetic nav-cta">
            <span></span>
            <em>Open Spawn Atlas</em>
        </a>
        {% if last_fetch %}
        <p class="last-fetch">Last fetch: {{ last_fetch }}</p>
        {% endif %}
    </div>
</section>

<section class="info-panel reveal">
    <p><strong>{{ events|length }}</strong> spawn-driven events indexed in the current cycle.</p>
</section>

{% if events %}
<section id="spawn-grid" class="event-grid">
    {% for event in events %}
    <article class="event-card reveal">
        {% if event.hero_image %}
        <img src="{{ event.hero_image }}" alt="{{ event.title or event.name }}" class="event-image">
        {% endif %}

        <div class="event-content">
            {% if event.is_ongoing %}
            <div class="ongoing-badge">
                <span class="ongoing-dot"></span>
                <span>ONGOING</span>
            </div>
            {% endif %}

            {% if event.detail_types %}
            <div class="event-types">
                {% for type in event.detail_types %}
                <span class="event-type-badge {{ type|lower|replace(' ', '-') }}">{{ type }}</span>
                {% endfor %}
            </div>
            {% endif %}

            <h3 class="event-title">{{ event.title or event.name }}</h3>

            {% if event.start_date and event.start_time %}
            <div class="event-date">
                ðŸ“… {{ event.start_date }} {{ event.start_time }}
                {% if event.end_date and event.end_time %}
                <br>to {{ event.end_date }} {{ event.end_time }}
                {% endif %}
            </div>
            {% endif %}

            {% if event.spawns and event.spawns|length > 0 %}
            <div class="spawn-section">
                <span class="spawn-count">{{ event.spawns|length }} PokÃ©mon</span>
                <div class="spawn-grid">
                    {% for pokemon in event.spawns %}
                    <div class="spawn-pokemon">
                        {% if pokemon.image %}
                        <img src="{{ pokemon.image }}" alt="{{ pokemon.name }}">
                        {% endif %}
                        <span class="spawn-pokemon-name">{{ pokemon.name }}</span>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            {% if event.additional_sections %}
            {% for section in event.additional_sections %}
            {% if section.category != "raid" %}
            <div class="section-toggle">
                <div class="raid-title" onclick="toggleSection(this)">{{ section.icon }} {{ section.display_title }}</div>
                <div class="raid-content">
                    {% if section.type == "grouped" %}
                        {% for group in section.groups %}
                        <div class="raid-tier">
                            {% if group.title %}
                            <div class="raid-tier-name">{{ group.title }}</div>
                            {% endif %}
                            <div class="raid-pokemon-list">
                                {% for pokemon in group.items %}
                                <div class="raid-pokemon">
                                    {% if pokemon.image %}
                                    <img src="{{ pokemon.image }}" alt="{{ pokemon.name }}">
                                    {% endif %}
                                    <span>{{ pokemon.name }}</span>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endfor %}
                    {% elif section.type == "list" %}
                        <div class="raid-pokemon-list">
                            {% for pokemon in section["items"] %}
                            <div class="raid-pokemon">
                                {% if pokemon.image %}
                                <img src="{{ pokemon.image }}" alt="{{ pokemon.name }}">
                                {% endif %}
                                <span>{{ pokemon.name }}</span>
                            </div>
                            {% endfor %}
                        </div>
                    {% elif section.type == "text" %}
                        <p class="section-text">{{ section.content }}</p>
                    {% endif %}
                </div>
            </div>
            {% endif %}
            {% endfor %}
            {% endif %}

            {% if event.url %}
            <a href="{{ event.url }}" target="_blank" rel="noopener noreferrer" class="event-link">View on Leek Duck â†’</a>
            {% endif %}
        </div>
    </article>
    {% endfor %}
</section>
{% else %}
<div class="no-spawns reveal">
    <p>No spawn events currently available in the feed.</p>
</div>
{% endif %}
{% endblock %}